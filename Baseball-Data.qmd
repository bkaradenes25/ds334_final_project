---
title: "Final"
author: "Brendan Karadenes"
format:
  html:
    embed-resources: true
---
## Introduction

For my final project I am working on using MLB data from the baseball r package. I'm interested in creating batting spray charts for each ball in play in the playoffs.


```{r}
library(baseballr)
library(tidyverse)

# Used guide on CMU website to scrape data

mlb_batted_balls_2023 <- 
  scrape_statcast_savant_batter_all(start_date = "2023-10-03",
                                    end_date = "2023-10-10") %>%
  filter(type == "X")

```

```{r}
playoffs <- 
  scrape_statcast_savant_batter_all(start_date = "2023-10-03",
                                    end_date = "2023-10-10") %>%
  filter(type == "X")
```


```{r}
choices <- mlb_batted_balls_2023 |> distinct(player_name) |> pull(player_name)
library(shiny)
ui <- fluidPage(
  sidebarLayout(
    sidebarPanel(
    selectInput("player_name", label = "Choose a Player",
                choices = choices, selected = "Trout, Mike")
  ),
  mainPanel(
    plotOutput("spray_chart")
  )
)
)

server <- function(input, output, session) {
  base_graph <- reactive({
    mlb_batted_balls_2023 %>%
      filter(player_name == input$player_name)
  })
  output$spray_chart <- renderPlot({
    filtered_data <- base_graph()
    ggspraychart(
  data = filtered_data,
  x_value = "hc_x",
  y_value = "-hc_y",
  fill_value = NULL,
  fill_palette = NULL,
  fill_legend_title = NULL,
  density = FALSE,
  bin_size = 15,
  point_alpha = 0.75,
  point_size = 2,
  frame = NULL
)
  })
}

shinyApp(ui, server)
```


